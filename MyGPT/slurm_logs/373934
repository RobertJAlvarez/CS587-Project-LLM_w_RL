[nltk_data] Downloading package punkt to /home/alvar258/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
/home/alvar258/CS587-Project-LLM_w_RL/MyGPT/train_policy.py:206: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=device))
/home/alvar258/CS587-Project-LLM_w_RL/MyGPT/train_policy.py:291: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  policy.load_state_dict(torch.load(best_policy_path))
Using device: cuda
Model loaded from models/best_gpt_model.pt
Training policy using 'KV cache'
Loaded 800 prompt-reference pairs.
Epoch 1: Loss -0.0015 Reward 0.7298
Epoch 2: Loss -0.0015 Reward 0.7929
Epoch 3: Loss -0.0016 Reward 0.7301
Epoch 4: Loss -0.0016 Reward 0.7820
Epoch 5: Loss -0.0016 Reward 0.7283
Epoch 6: Loss -0.0017 Reward 0.7267
Epoch 7: Loss -0.0018 Reward 0.8358
Epoch 8: Loss -0.0018 Reward 0.7044
Epoch 9: Loss -0.0018 Reward 0.7559
Epoch 10: Loss -0.0018 Reward 0.8422
Epoch 11: Loss -0.0019 Reward 0.7479
Epoch 12: Loss -0.0019 Reward 0.7477
Total training time = 127.9407s

=== Evaluation Results Without Policy ===
Avg Fluency Score: 0.6825
Avg Coherence Score (BLEU): 0.8665
Avg ROUGE-L Score: 0.8852
Diversity Score (1-SelfBLEU): 0.9119
Total gen w/o policy time = 9.7088s

=== Evaluation Results With Policy ===
Avg Fluency Score: 0.6883
Avg Coherence Score (BLEU): 0.8841
Avg ROUGE-L Score: 0.9080
Diversity Score (1-SelfBLEU): 0.9073
Total gen w/ policy time = 9.5860s
======================
** Prompt **
“Most willingly.”
** Gen w/ policy **
“Most willingly.”
** Gen w/o policy **
“Most willingly.”
** Reference **
“Most willingly.” 
======================
======================
** Prompt **
“By calculation; given the size
** Gen w/ policy **
“By calculation; given the size of the vessel, which you know, sir, and
consequently the quantity of air it contains, knowing also how much
each man expends at a breath, and comparing these results with the fact
that the _Nautilus_ is obliged to go to the surface every twenty-four
hours.”
** Gen w/o policy **
“By calculation; given the size of the vessel, which you know, sir, and
consequently the quantity of air it contains, knowing also how much
each man expends at a breath, and comparing these results with the fact
that the _Nautilus_ is obliged to go to the surface every twenty-four
hours.”
** Reference **
“By calculation; given the size of the vessel, which you know, sir, and consequently the quantity of air it contains, knowing also how much each man expends at a breath, and comparing these results with the fact that the _Nautilus_ is obliged to go to the surface every twenty-four hours.”
======================
======================
** Prompt **
“Yes, sir; that is the
** Gen w/ policy **
“Yes, sir; that is the subject on which I wish to question you. For
seven months we have been here on board, and I ask you to-day, in the
name of my companions and in my own, if your intention is to keep us
here always?”
** Gen w/o policy **
“Yes, sir; that is the subject on which I wish to question you. For
seven months we have been here on board, and I ask you to-day, in the
name of my companions and in my own, if your intention is to keep us
here always?”
** Reference **
“Yes, sir; that is the subject on which I wish to question you. For seven months we have been here on board, and I ask you to-day, in the name of my companions and in my own, if your intention is to keep us here always?”
======================
